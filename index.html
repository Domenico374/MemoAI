<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Test Minutes</title>
  <style>
    body{font-family:system-ui,Arial;margin:2rem}
    textarea,input,button{font-size:16px}
    pre{background:#0f172a;color:#e2e8f0;padding:12px;border-radius:8px;white-space:pre-wrap}
  </style>
</head>
<body>
  <h1>Test /api/minutes</h1>
  <p>Scrivi due righe di appunti e premi “Genera”.</p>

  <label>Oggetto <input id="subject" placeholder="Allineamento Q4" /></label><br/><br/>
  <textarea id="notes" rows="8" cols="80" placeholder="- punto 1&#10;- decisione: procedere&#10;- KPI: lead settimanali 30"></textarea><br/><br/>
  <button id="go">Genera</button>

  <h2>Risultato</h2>
  <pre id="out">(in attesa…)</pre>

<script>
const $ = s => document.querySelector(s);
$('#go').onclick = async () => {
  const body = {
    notes: $('#notes').value,
    subject: $('#subject').value,
    meetingDate: new Date().toISOString().slice(0,10),
    participants: 'Mario, Laura',
    formatoVerbale: 'standard'
  };
  try{
    const r = await fetch('/api/minutes', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(body)
    });
    const ct = r.headers.get('content-type')||'';
    const data = ct.includes('application/json') ? await r.json() : await r.text();
    $('#out').textContent = `HTTP ${r.status}\n\n` + (typeof data==='string' ? data : JSON.stringify(data,null,2));
  }catch(e){
    $('#out').textContent = 'ERRORE: ' + (e.message||e);
  }
};
</script>
</body>
</html>
