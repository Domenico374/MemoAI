<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Memo AI</title>

  <!-- Tailwind + Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>

  <!-- DOCX preview -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

  <!-- PDF preview -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      var lib = window.pdfjsLib || (window['pdfjs-dist/build/pdf'] || null);
      if (lib && lib.GlobalWorkerOptions) {
        lib.GlobalWorkerOptions.workerSrc =
          'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
        window.pdfjsLib = lib;
      }
    });
  </script>

  <style>
    .notification{
      position: fixed; left:50%; transform:translateX(-50%);
      bottom: 16px; padding:10px 14px; border-radius:10px;
      background:#0ea5e9; color:#fff; z-index:50; opacity:0; transition:.25s;
      box-shadow:0 10px 30px rgba(2,6,23,.15);
    }
    .notification.is-danger{ background:#ef4444; }
    .notification.is-warning{ background:#f59e0b; }
    .notification.is-info{ background:#06b6d4; }

    .drop-zone.is-dragover {
      background: #dbeafe;
      border-color: #3b82f6;
    }

    #fullscreenOverlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.95);
      z-index: 9999;
      overflow: auto;
    }
    #fullscreenOverlay.active {
      display: block;
    }
    #fullscreenContent {
      padding: 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-800">
  <!-- Toast -->
  <div id="toast" class="notification"></div>

  <!-- Fullscreen Overlay -->
  <div id="fullscreenOverlay">
    <div class="sticky top-0 bg-black/50 p-4 flex justify-end">
      <button onclick="closeFullscreen()" class="px-4 py-2 bg-white rounded text-slate-900 hover:bg-slate-100">
        <i class="fa-solid fa-times mr-2"></i>Chiudi
      </button>
    </div>
    <div id="fullscreenContent"></div>
  </div>

  <!-- NAVBAR -->
  <header class="sticky top-0 z-30 border-b bg-white/90 backdrop-blur">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-blue-600 text-white font-bold">M</span>
        <span class="font-semibold text-lg">Memo AI</span>
        <span id="navStatusApi" class="ml-3 text-xs px-2 py-1 rounded-full bg-slate-200 text-slate-700">checking…</span>
      </div>
      <div class="flex items-center gap-4">
        <div class="hidden md:flex items-center gap-4 text-xs text-slate-500">
          <span>File: <strong id="fileCount">0</strong></span>
          <span>Coda: <strong id="queueCount">0</strong></span>
          <span id="saveStatus" class="text-emerald-600"></span>
        </div>
        <nav class="flex items-center gap-4 text-sm">
          <a class="text-slate-500 hover:text-blue-600" href="#">Guida</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-4 md:p-6">
    <!-- Upload con Drag & Drop -->
    <section class="bg-white border rounded-xl p-4 md:p-5 shadow-sm">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold">Carica file</h2>
        <div class="flex items-center gap-2">
          <button id="btnUpload" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            <i class="fa-solid fa-file-arrow-up mr-2"></i>Seleziona
          </button>
          <button id="btnClearQueue" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Pulisci coda
          </button>
        </div>
      </div>
      
      <div id="dropArea" class="drop-zone border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:bg-slate-50 transition">
        <div id="dropZone">
          <i class="fa-solid fa-cloud-arrow-up text-4xl text-slate-400 mb-2"></i>
          <p class="text-sm text-slate-600">Trascina i file qui o clicca per selezionare</p>
          <p class="text-xs text-slate-400 mt-1">PDF, DOCX, TXT, MD, Immagini, Audio, Video</p>
        </div>
      </div>
      
      <input id="uploader" type="file" class="hidden" multiple accept=".pdf,.docx,.txt,.md,.png,.jpg,.jpeg,.webp,.svg,.mp3,.m4a,.wav,.ogg,.flac,.mp4,.webm,.mov" />
      
      <!-- Coda file -->
      <div class="mt-4">
        <h3 class="text-sm font-semibold text-slate-600 mb-2">Coda elaborazione</h3>
        <ul id="queue" class="space-y-2"></ul>
      </div>
    </section>

    <!-- Anteprima -->
    <section class="bg-white border rounded-xl p-4 md:p-5 shadow-sm mt-4">
      <div class="flex items-center justify-between">
        <h2 class="font-semibold">Anteprima</h2>
        <div class="flex items-center gap-2">
          <button id="btnFullscreen" class="hidden md:inline px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            <i class="fa-solid fa-expand mr-1"></i>Schermo intero
          </button>
          <button id="btnClearPreview" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Pulisci
          </button>
        </div>
      </div>
      <div id="preview" class="mt-3 min-h-[120px] grid place-items-center rounded-lg bg-slate-100/60 border border-dashed">
        <p class="text-sm text-slate-400">L'anteprima comparirà qui…</p>
      </div>
    </section>

    <!-- Appunti -->
    <section class="bg-white border rounded-xl p-4 md:p-5 shadow-sm mt-4">
      <div class="flex items-center justify-between">
        <h2 class="font-semibold">Appunti</h2>
        <div class="flex items-center gap-2">
          <span id="charCount" class="text-xs text-slate-500">0 caratteri</span>
          <button id="btnTranscribe" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            <i class="fa-solid fa-microphone mr-1"></i>Trascrivi
          </button>
          <button id="btnClean" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Pulisci testo
          </button>
          <button id="btnReset" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Reset
          </button>
        </div>
      </div>
      <textarea id="notes" class="mt-3 w-full h-56 md:h-64 p-3 rounded-lg border outline-none focus:ring-2 focus:ring-blue-400 bg-slate-50 font-mono text-sm"
        placeholder="Scrivi o incolla i tuoi appunti qui, oppure carica un file sopra…"></textarea>
    </section>

    <!-- Analisi intelligente -->
    <section class="bg-white border rounded-xl p-4 md:p-5 shadow-sm mt-4">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold">Analisi intelligente</h2>
        <div class="flex flex-wrap gap-2">
          <button id="btnSummarize" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Riassunto
          </button>
          <button id="btnHighlights" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Punti salienti
          </button>
          <button id="btnTodos" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            To-Do
          </button>
          <button id="btnSuggestTags" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Tag
          </button>
        </div>
      </div>

      <div class="grid md:grid-cols-2 gap-4">
        <div class="p-3 rounded-lg border bg-slate-50">
          <div class="text-xs font-semibold text-slate-500 mb-2">Riassunto</div>
          <pre id="summaryBox" class="text-sm whitespace-pre-wrap text-slate-700">—</pre>
        </div>
        <div class="p-3 rounded-lg border bg-slate-50">
          <div class="text-xs font-semibold text-slate-500 mb-2">Punti salienti</div>
          <pre id="highlightsBox" class="text-sm whitespace-pre-wrap text-slate-700">—</pre>
        </div>
        <div class="p-3 rounded-lg border bg-slate-50">
          <div class="text-xs font-semibold text-slate-500 mb-2">Attività da fare</div>
          <pre id="todoBox" class="text-sm whitespace-pre-wrap text-slate-700">—</pre>
        </div>
        <div class="p-3 rounded-lg border bg-slate-50">
          <div class="text-xs font-semibold text-slate-500 mb-2">Tag suggeriti</div>
          <div id="tagsBox" class="text-sm text-slate-700">—</div>
        </div>
      </div>
    </section>

    <!-- Verbale -->
    <section class="bg-white border rounded-xl p-4 md:p-5 shadow-sm mt-4">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold">Verbale</h2>
        <div class="flex flex-wrap items-center gap-2">
          <button id="btnGenerate" class="px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm">
            <i class="fa-solid fa-wand-magic-sparkles mr-1"></i>Genera
          </button>
          <button id="btnMinutesAI" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            AI Verbale
          </button>
          <button id="btnCopy" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            Copia
          </button>
          <button id="btnDownload" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            .md
          </button>
          <button id="btnExportPDF" class="px-3 py-1.5 rounded-lg border bg-slate-50 hover:bg-slate-100 text-sm">
            PDF
          </button>
        </div>
      </div>
      <pre id="result" class="bg-slate-900 text-slate-100 p-4 rounded-lg overflow-auto min-h-[200px] whitespace-pre-wrap text-sm font-mono">Il verbale comparirà qui…</pre>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
